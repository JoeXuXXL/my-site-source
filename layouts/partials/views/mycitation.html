{{/*
  layouts/partials/views/mycitation.html
  This file renders a SINGLE publication item.
*/}}

{{/* Define variables from the context passed by the start file */}}
{{ $page := .item }}
{{ $params := $page.Params }}
{{ $item_number := .number }}

<div class="flex items-start space-x-4">
  <!-- 1. The publication number -->
  <div class="flex-shrink-0 text-lg font-medium text-gray-500 dark:text-gray-400 w-12 text-right">
    [P{{ $item_number }}]
  </div>
  
  <!-- The main publication content -->
  <div class="flex-grow">
    <!-- Title -->
    <h3 class="text-xl font-semibold leading-snug">
      <a href="{{ $page.RelPermalink }}" class="text-gray-900 dark:text-white hover:text-primary-600 dark:hover:text-primary-400">{{ $page.Title }}</a>
    </h3>

    <!-- 3. Authors (with your name bolded) -->
    {{ with $params.authors }}
    <div class="mt-1 text-base text-gray-600 dark:text-gray-400">
      {{ $authors := delimit . ", " }}
      {{ $authors_processed := replace $authors "Xiangling Xu" "**Xiangling Xu**" }}
      {{ $authors_processed | markdownify }}
    </div>
    {{ end }}

    <!-- Publication Venue -->
    {{ with $params.publication }}
    <div class="mt-1 text-base italic text-gray-500 dark:text-gray-500">
      {{ . | markdownify }}
    </div>
    {{ end }}
    
    <!-- 2. Action Links (parsed from existing front matter) -->
    <div class="mt-3 flex flex-wrap gap-3">
      {{/* Link to the generated cite.bib file */}}
      {{ with $page.GetPage "cite.bib" }}
        <a class="btn btn-xs" href="{{ .RelPermalink }}" target="_blank">Cite</a>
      {{ end }}

      {{/* Check for a DOI in the hugoblox.ids map */}}
      {{ with $params.hugoblox.ids.doi }}
        <a class="btn btn-xs" href="{{ . }}" target="_blank" rel="noopener">DOI</a>
      {{ end }}

      {{/* Loop through the 'links' array to find arXiv, PDF, etc. */}}
      {{ range $params.links }}
        {{ if eq .name "arXiv" }}
          <a class="btn btn-xs" href="{{ .url }}" target="_blank" rel="noopener">arXiv</a>
        {{ else if eq .name "PDF" }}
          <a class="btn btn-xs" href="{{ .url }}" target="_blank" rel="noopener">PDF</a>
        {{ else if eq .name "URL" }}
          {{/* Generic fallback link, maybe for project page */}}
          <a class="btn btn-xs" href="{{ .url }}" target="_blank" rel="noopener">Link</a>
        {{ end }}
      {{ end }}
    </div>
  </div>
</div>